(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{60:function(e,t,n){},96:function(e,t,n){},97:function(e,t,n){},98:function(e,t,n){"use strict";n.r(t);var s=n(1),a=n.n(s),c=n(50),i=n.n(c),o=n(31),r=n(13),l=n(14),h=n(4),d=n(16),j=n(15),u=n(17),b=n(2),x=n(21);n(57);function p(e){if(!e)return null;try{var t=localStorage.getItem(e);return t?JSON.parse(t):null}catch(n){return null}}function O(e,t){e||console.log("Error: Key is missing");try{localStorage.setItem(e,JSON.stringify(t))}catch(n){console.log(n)}}function m(e,t,n){fetch("".concat(e,"users/login"),{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){e.success&&n(e)}))}n(60);var v=n(0),g=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var s;return Object(r.a)(this,n),(s=t.call(this,e)).state={token:"",userData:{},proxy:"https://epicenter-am.herokuapp.com/api/"},s}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return Object(v.jsx)(f.Provider,{value:{state:this.state,changeToken:function(t){return e.setState({token:t})},setUserData:function(t){return e.setState({userData:t})}},children:this.props.children})}}]),n}(s.Component),f=a.a.createContext(),k=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var s;return Object(r.a)(this,n),(s=t.call(this,e)).state={register:s.props.register,name:"",email:"",password:"",redirect:!1},s.onChange=s.onChange.bind(Object(h.a)(s)),s.select1=s.select1.bind(Object(h.a)(s)),s.select2=s.select2.bind(Object(h.a)(s)),s.onSubmit=s.onSubmit.bind(Object(h.a)(s)),s}return Object(l.a)(n,[{key:"onChange",value:function(e){this.setState(Object(x.a)({},e.target.name,e.target.value))}},{key:"select1",value:function(){this.setState({register:!1})}},{key:"select2",value:function(){this.setState({register:!0})}},{key:"onSubmit",value:function(e){var t,n,s,a=this,c=this.state,i=c.name,o=c.email,r=c.password;if(e.preventDefault(),this.state.register){var l={name:i,email:o,password:r};t=this.context.state.proxy,n=l,s=function(e){m(a.context.state.proxy,l,(function(t){var n=e.user,s=n.email,c=n.name,i=n.conversations,o=n.tag,r=n._id;a.context.setUserData({email:s,name:c,conversations:i,_id:r,tag:o}),O("Epicenter",{token:t.token}),a.context.changeToken(t.token),a.setState({name:"",email:"",password:"",redirect:!0}),a.props.changeToken(t.token)}))},fetch("".concat(t,"users/register"),{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(e){e.success&&s(e)}))}else{var h={email:o,password:r};m(this.context.state.proxy,h,(function(e){var t=e.user,n=t.email,s=t.name,c=t.conversations,i=t.tag,o=t._id;a.context.setUserData({email:n,name:s,conversations:c,tag:i,_id:o}),O("Epicenter",{token:e.token}),a.context.changeToken(e.token),a.props.changeToken(e.token),a.setState({name:"",email:"",password:"",redirect:!0})}))}}},{key:"render",value:function(){return this.state.redirect?Object(v.jsx)(b.a,{to:"/chat"}):Object(v.jsxs)("div",{id:"body",children:[Object(v.jsx)("div",{className:"navbar",children:Object(v.jsxs)("div",{className:"container flex",children:[Object(v.jsx)("a",{href:"index.html",children:Object(v.jsx)("h1",{className:"logo",children:"Epicenter"})}),Object(v.jsx)("nav",{children:Object(v.jsxs)("ul",{children:[Object(v.jsx)("li",{children:Object(v.jsx)("a",{href:"#home",children:"Home"})}),Object(v.jsx)("li",{children:Object(v.jsx)("a",{href:"#downloads",children:"Download"})}),Object(v.jsx)("li",{children:Object(v.jsx)("a",{href:"#login-register",children:"Login/Register"})})]})})]})}),Object(v.jsx)("div",{className:"main",children:Object(v.jsxs)("div",{id:"show-wrapper",className:"show-wrapper stuff",children:[Object(v.jsxs)("div",{id:"home",children:[Object(v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1440 320",children:Object(v.jsx)("path",{fill:"#B35AA8",fillOpacity:"1",d:"M0,96L1440,320L1440,320L0,320Z"})}),Object(v.jsxs)("div",{className:"title-wrapper",children:[Object(v.jsxs)("h1",{id:"showcase-title",children:["The Perfect",Object(v.jsx)("br",{}),"Place To",Object(v.jsx)("br",{}),"Talk."]}),Object(v.jsx)("p",{children:"Epicenter is the best place to chat with friends!"}),Object(v.jsx)("center",{children:Object(v.jsx)("a",{href:"#login-register",children:Object(v.jsx)("button",{children:"Start Chatting"})})})]})]}),Object(v.jsx)("div",{id:"downloads",children:Object(v.jsxs)("div",{id:"section2",children:[Object(v.jsx)("div",{id:"blackthing"}),Object(v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1440 320",children:Object(v.jsx)("path",{fill:"#333",fillOpacity:"1",d:"M0,288L1440,160L1440,320L0,320Z"})}),Object(v.jsxs)("div",{className:"title-wrapper",children:[Object(v.jsx)("h1",{id:"showcase-title",children:"We are currently not offering any downloads."}),Object(v.jsx)("p",{children:"Stay tuned for upcoming releases!"})]})]})}),Object(v.jsx)("div",{id:"login-register",children:Object(v.jsx)("div",{id:"auth-wrapper",className:"auth-wrapper stuff",children:Object(v.jsxs)("div",{className:"auth",children:[Object(v.jsx)("div",{className:this.state.register?"label1":"label1 auth-selected",onClick:this.select1,children:"Login"}),Object(v.jsx)("div",{className:this.state.register?"label2 auth-selected":"label2",onClick:this.select2,children:"Register"}),Object(v.jsxs)("div",{className:"infoarea auth-selected",children:[this.state.register?Object(v.jsxs)("div",{children:[Object(v.jsx)("label",{htmlFor:"name",children:"Name: "}),Object(v.jsx)("br",{}),Object(v.jsx)("input",{type:"text",className:"editinput",name:"name",value:this.state.name,onChange:this.onChange})]}):null,Object(v.jsxs)("div",{children:[Object(v.jsx)("label",{htmlFor:"username",children:"Email: "}),Object(v.jsx)("br",{}),Object(v.jsx)("input",{type:"email",className:"editinput",name:"email",value:this.state.email,onChange:this.onChange})]}),Object(v.jsxs)("div",{children:[Object(v.jsx)("label",{htmlFor:"username",children:"Password: "}),Object(v.jsx)("br",{}),Object(v.jsx)("input",{type:"password",className:"editinput",name:"password",value:this.state.password,onChange:this.onChange})]}),Object(v.jsx)("div",{children:Object(v.jsx)("button",{onClick:this.onSubmit,children:"Submit"})})]})]})})})]})})]})}}]),n}(s.Component),y=k;k.contextType=f;var w=n(52),S=n.n(w),C=(n(96),function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var s;return Object(r.a)(this,n),(s=t.call(this,e)).state={redirect:!1,new:!1,name:"",convoid:s.props.match.params.id,conversation:{},isLoading:!0,message:"",newFocused:!1},s.socket=S()("https://epicenter-am.herokuapp.com"),s.messagesEnd=a.a.createRef(),s.inputRef=a.a.createRef(),s.logout=s.logout.bind(Object(h.a)(s)),s.onNew=s.onNew.bind(Object(h.a)(s)),s.onChange=s.onChange.bind(Object(h.a)(s)),s.onSend=s.onSend.bind(Object(h.a)(s)),s.scrollToBottom=s.scrollToBottom.bind(Object(h.a)(s)),s.onFocus=s.onFocus.bind(Object(h.a)(s)),s.onBlur=s.onBlur.bind(Object(h.a)(s)),s}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.state.isLoading||(this.scrollToBottom(),this.state.convoid&&this.inputRef.current.focus()),this.socket.on("refresh-convo",(function(){fetch("".concat(e.context.state.proxy,"users/verify?token=").concat(e.context.state.token)).then((function(e){return e.json()})).then((function(t){e.context.setUserData(t.user)}))})),void 0!==this.state.convoid?this.context.state.userData.conversations.forEach((function(t){t._id===e.state.convoid&&(e.socket.emit("join-room",e.state.convoid,e.context.state.userData._id),e.setState({conversation:t,isLoading:!1}))})):this.setState({isLoading:!1})}},{key:"componentDidUpdate",value:function(e,t){var n=this;this.state.isLoading||(this.scrollToBottom(),!this.state.newFocused&&this.state.convoid&&this.inputRef.current.focus()),t.conversation._id!==this.state.convoid&&this.context.state.userData.conversations.forEach((function(e){e._id===n.state.convoid&&(n.socket.emit("join-room",n.state.convoid,n.context.state.userData._id),n.setState({conversation:e,isLoading:!1}))}))}},{key:"onBlur",value:function(){this.setState({newFocused:!1})}},{key:"onFocus",value:function(){this.setState({newFocused:!0})}},{key:"onChange",value:function(e){this.setState(Object(x.a)({},e.target.name,e.target.value))}},{key:"onNew",value:function(e){var t=this;if(e.preventDefault(),!1===this.state.new)this.setState({new:!0});else{var n=this.state.name,s=n.split("#")[0],a=n.split("#")[1];fetch("".concat(this.context.state.proxy,"conversations/new"),{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({name:s,tag:a,userid:this.context.state.userData._id})}).then((function(e){return e.json()})).then((function(e){e.success&&(console.log(e),t.socket.emit("conversation-created"),t.props.history.push("/".concat(e.message._id)))}))}}},{key:"scrollToBottom",value:function(){}},{key:"onSend",value:function(e){var t=this,n=this.context.state.userData.name,s=this.state.message,a=this.state.convoid;new Date;e.preventDefault(),fetch("".concat(this.context.state.proxy,"conversations/send"),{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({author:n,text:s,convoid:a})}).then((function(e){return e.json()})).then((function(e){e.success&&(t.socket.emit("message-sent",t.state.convoid),t.setState({message:""}))}))}},{key:"logout",value:function(e){var t=this;e.preventDefault();var n=p("Epicenter");n&&n.token&&fetch(this.context.state.proxy+"users/logout?token="+n.token).then((function(e){return e.json()})).then((function(e){e.success&&(t.props.setParentToken(""),t.context.changeToken(""),t.context.setUserData({}))}))}},{key:"render",value:function(){var e=this,t=this.state.conversation,n=t.people,s=t.messages;return!0===this.state.isLoading?"isLoading":Object(v.jsxs)("div",{id:"body",children:[Object(v.jsx)("div",{className:"navbar",children:Object(v.jsxs)("div",{className:"container flex",children:[Object(v.jsx)("a",{href:"index.html",children:Object(v.jsx)("h1",{className:"logo",children:"Epicenter"})}),Object(v.jsx)("nav",{children:Object(v.jsx)("ul",{children:Object(v.jsx)("li",{children:Object(v.jsx)(u.b,{to:"/",onClick:this.logout,children:"Logout"})})})})]})}),Object(v.jsx)("div",{className:"main",children:Object(v.jsx)("div",{style:{overflow:"hidden"},id:"show-wrapper2",className:"show-wrapper stuff",children:Object(v.jsxs)("main",{children:[Object(v.jsxs)("div",{className:"listnav",children:[Object(v.jsxs)("h3",{children:[this.context.state.userData.name,"#",this.context.state.userData.tag]}),Object(v.jsx)("hr",{}),Object(v.jsx)("nav",{children:Object(v.jsxs)("ul",{children:[this.context.state.userData.conversations.map((function(t,n){return t.people[0]===e.context.state.userData.name?Object(v.jsx)(u.b,{to:"/chat/"+t._id,children:Object(v.jsx)("li",{style:{backgroundColor:t._id===e.state.convoid?"rgb(61, 60, 60)":null},children:Object(v.jsx)("p",{children:t.people[1]})})},n):Object(v.jsx)(u.b,{to:"/chat/"+t._id,children:Object(v.jsx)("li",{style:{backgroundColor:t._id===e.state.convoid?"rgb(61, 60, 60)":null},children:Object(v.jsx)("p",{children:t.people[0]})})},n)})),this.state.new?Object(v.jsx)("li",{id:"buttonwrap",children:Object(v.jsx)("input",{onBlur:this.onBlur,onFocus:this.onFocus,name:"name",onChange:this.onChange,value:this.state.name,type:"text",className:"new-input",placeholder:"ex. Steve#0"})}):null,Object(v.jsx)("li",{id:"buttonwrap",children:Object(v.jsx)("button",{onClick:this.onNew,className:"new",children:this.state.new?"Create DM":"New DM +"})})]})})]}),Object(v.jsxs)("div",{className:"chat",children:[Object(v.jsx)("div",{className:"top",children:n?Object(v.jsxs)("h2",{children:["@",n[0]===this.context.state.userData.name?n[1]:n[0]]}):"Select a person to talk to!"}),Object(v.jsx)("div",{ref:this.messagesEnd,className:"chatarea",children:s?s.slice(0).reverse().map((function(e,t){return Object(v.jsxs)("div",{className:"msg",children:[Object(v.jsxs)("div",{children:[Object(v.jsx)("p",{children:Object(v.jsx)("b",{children:e.author})}),Object(v.jsx)("span",{children:e.date})]}),Object(v.jsx)("div",{children:Object(v.jsx)("p",{className:"msgtxt",children:e.text})})]},t)})):null}),Object(v.jsx)("div",{className:"type",children:this.state.convoid?Object(v.jsx)("form",{onSubmit:this.onSend,children:Object(v.jsx)("input",{ref:this.inputRef,type:"text",placeholder:n?"Message @".concat(n[0]===this.context.state.userData.name?n[1]:n[0]):null,value:this.state.message,onChange:this.onChange,name:"message"})}):null})]})]})})})]})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return{convoid:e.match.params.id}}}]),n}(s.Component)),N=C;C.contextType=f;n(97);var D=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var s;return Object(r.a)(this,n),(s=t.call(this,e)).state={isLoading:!0,error:"",token:s.props.token},s.setParentToken=s.setParentToken.bind(Object(h.a)(s)),s}return Object(l.a)(n,[{key:"setParentToken",value:function(e){this.setState({token:e})}},{key:"componentDidMount",value:function(){var e=this,t=p("Epicenter");t&&t.token?fetch("".concat(this.context.state.proxy,"users/verify?token=").concat(t.token)).then((function(e){return e.json()})).then((function(n){n.success?(e.context.changeToken(t.token),e.context.setUserData(n.user),console.log(n.user),e.setState({token:t.token,isLoading:!1})):e.setState({isLoading:!1})})):this.setState({isLoading:!1})}},{key:"render",value:function(){var e=this;return this.state.isLoading?Object(v.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",backgroundColor:"#333"},children:Object(v.jsx)("h1",{style:{color:"white"},children:"Loading..."})}):Object(v.jsx)(u.a,{basename:"/Epicenter",children:Object(v.jsxs)(b.d,{children:[Object(v.jsx)(b.b,{path:"/",exact:!0,strict:!0,render:function(){return Object(v.jsx)(a.a.Fragment,{children:""===e.state.token?Object(v.jsx)(y,{changeToken:function(t){return e.setState({token:t})},register:!1}):Object(v.jsx)(b.a,{to:"/chat"})})}}),Object(v.jsx)(b.b,{path:"/chat",exact:!0,component:function(t){return""!==e.state.token?Object(v.jsx)(N,Object(o.a)({userData:e.context.state.userData,setParentToken:e.setParentToken},t)):Object(v.jsx)(b.a,{to:"/"})}}),Object(v.jsx)(b.b,{path:"/chat/:id",exact:!0,strict:!0,component:function(t){return""!==e.state.token?Object(v.jsx)(N,Object(o.a)({userData:e.context.state.userData,setParentToken:e.setParentToken},t)):Object(v.jsx)(b.a,{to:"/"})}})]})})}}]),n}(s.Component),T=D;D.contextType=f;var L=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,99)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),s(e),a(e),c(e),i(e)}))},P=Object(v.jsx)(g,{children:Object(v.jsx)(f.Consumer,{children:function(e){return Object(v.jsx)(T,{token:e.state.token})}})});i.a.render(P,document.getElementById("root")),L()}},[[98,1,2]]]);
//# sourceMappingURL=main.be17e54f.chunk.js.map